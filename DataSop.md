# 資料處理流程
* 了解基本資料
    * 來源
        * 多處來源
        * 可靠度
        * 推測資料異常的理由與頻率
    * 檔案格式
    * 欄位意義、DataType
    * 資料量
    * 資料關係、欄位關係
* 統計量化/視覺化(scatter, histogram, boxplot)
    * 計算集中趨勢
        * 平均值 Mean
        * 中位數 Median
        * 眾數 Mode
    * 計算分散程度
        * 最⼩值 Min
        * 最⼤值 Max
        * 範圍 Range
        * 四分位差 Quartiles
        * 變異數 Variance
        * 標準差 Standard deviation
    * 得知有無缺資料、錯誤
        * 缺某一段期間
        * 偶爾缺某一格
        * 除了上述方法還可透過五值, zscore, IQR 來檢查異常(離群值、...)
* 統一格式(csv, datetimeoffset, ...)
* 資料清理
    * 缺失值填補(不要破壞資料分布，不要變成離群值，可另加欄位記錄為缺失)
        * 數值型欄位
            * 偏態不明顯時填平均值
            * 偏態明顯時填中位數
            * 分組後填分位數
        * 類別型欄位
            * 填眾數
            * 填預設值(-1, 0, 999, ...)
        * 依意義補指定值
        * 補預測值(可能導致overfitting)
    * 離群值outlier處理(數值型欄位)
        * 了解該數值會離群的可能原因，再決定是否處理，以免刪除掉重要資訊
            * 可能原本為缺失值已被填0或其它數字而變成離群值
            * 有些情況可用去偏態的解法即可解決(離群值比例太高)
        * 若決定要處理，解決方法:
            * 合成新欄位(分組)
            * 新增兩個欄位
                * 一個⽤以紀錄異常與否
                * 一個為修正後的值：
                    * 以 mean, median, min, max, quantile, na 填補(取代)
                    * 以 max+n, min-n 取代
            * 或整欄/整列資料不使用
* 特徵處理
    * 數值型
        * 去偏態(使更接近常態分佈，讓平均值具代表性)
            * 對數去偏: 用於非負且可能為 0 的欄位。+1再取log，還原時取exp再-1
            * 方根去偏: 最大值有限時適用。減去最小值再開根號
            * 分布去偏: 用於正數不可為 0 的欄位。lambda 參數 0 ~ 0.5
        * 特徵縮放(以合理的⽅式, 平衡特徵間的影響⼒)
            * 是否適合縮放
                * SVM, DL 等對權重敏感或對損失函數平滑程度有幫助者就適合
                * 特徵間的量級差異甚大也適合
                * 相關性的指標不適合
                * 量的單位在特徵上有意義者也不適合
            * 影響
                * 非樹狀模型(線性迴歸、羅吉斯迴歸、類神經)：有影響
                * 樹狀模型(決策樹、隨機森林、梯度提升樹)：沒有太⼤影響
            * 方法
                * Standard Scaler 標準化適合常態分佈, 不易受到極端值影響
                    * z 轉換法：(x-mean(x))/std(x)
                    * 空間壓縮法
                        * 控制在0~1之間：(x-min(x))/(max(x)-min(x))
                        * 控制在-1~1之間：((x-min(x))/(max(x)-min(x))-0.5) * 2
                        * Qlow/Qhigh normalization: 上述的 min, max 改用 q1, q99
                        * 控制在0~1之間(針對特別影像): x/255
                * MinMax Scaler 最⼩最⼤化, 適合均勻分佈, 容易受到極端值影響
                    * 已除去離群值者適合用
        * 離散化
    * 類別型
        * Label encoding
            * 把每個類別 mapping 到某個整數，不會增加新欄位
            * 適用非深度學習模型，因為主要為樹狀模型，用兩次門檻就能分隔關鍵類別
            * 使⽤時機是資料為有序的，若無序時使用則編碼大小無意義
        * One Hot encoding
            * 為每個類別新增一個欄位，用 0/1 表示是否
            * 適用深度學習模型，因為倒傳遞，此方法會不易收斂
            * 使⽤時機是資料為無序的
            * 特徵重要性高且可能值較少時適用
        * 均值編碼
            * 以類別分組，用目標的平均值當作該類別的編碼
            * 當該類別欄位與目標有顯著相關時適用
            * 某類別筆數少時可靠度低
            * 容易overfitting
                * 以平滑化公式計算均值((原類別平均x類別樣本數+總平均x調整因子)/(類別樣本數+調整因子))
                * 用 cross validation 確認使用前後分數，適合再用
        * 計數編碼
            * 目標與各類別筆數有關時適用
        * 雜湊編碼: 類別數量大時適用，但雜湊後是否有意義
        * 嵌入式編碼
        * 自訂編碼
    * 時間型
        * 分欄處理: 年/月/日/時/分/秒/第幾週/星期幾/上下午/時段/季節
        * 週期: sin/cos
            * 年週期: 正(冷)負(熱): cos((月/6+日/180)PI)
            * 周週期: 正(精神好)負(累): sin((星期幾/3.5+小時/84)PI)
            * 日週期: 正(精神好)負(累): sin((小時/12+分/720+秒/43200)PI)
        * 計數
            * 事件發生前1小時內計數: 例如 17:05 的前一小時為 16:05 ~ 17:04
* 特徵組合/篩選
* 特徵評估